
# Deep learning network for shadow correction in remote sensing images

S. Luo, H. Li*, Y. Li, C. Shao, H. Shen and L. Zhang, "An Evolutionary Shadow Correction Network and a Benchmark UAV Dataset for Remote Sensing Images," IEEE Trans. on Geoscience and Remote Sensing, vol. 61, pp. 1-14, 2023, Art no. 5615414.

## Dataset and pre-trained model
Our UAV-SC dataset（including the refined version） and pre-trained model for shadow removal is available for download at Google Drive(Link: https://drive.google.com/drive/folders/1BAiUScnRZW5utx-zBZXAXVN3-sSdqIDq?usp=drive_link), in which UAV-SC is the same as the dataset we published previously (https://pan.baidu.com/s/1YiJ4SV_072Jj-L4up9CT-Q (password: vezt)) and UAV-SC_refine is the updated version.

## Requisites
Main dependent packages：
- PyTorch 1.10.1
- Python 3.6
- beautifulsoup4==4.12.3
- dominate==2.7.0
- numpy==1.19.5
- Pillow==8.4.0
- requests==2.27.1
- scikit_image==0.17.2
- scipy==1.5.4
- torchvision==0.11.2
- visdom==0.2.4
- 
Other package details could be found in requirements.txt in this project.

## Shadow Removal Network(SRNet)

You should download our dataset and put it into the folder of datasets first. 
#### Train
if you want to train the model by yourself, you need to run Combine_A_and_B.py to combine the shaded and unshaded image to get the train data.
```
python train.py --model pix2pix --dataset ./datasets/UAV-SC/train/train
```
The trained model will be saved at the following path: `./checkpoints`. This folder could be generated by our code autoAutomatically.

#### Test
```
python test.py --model test --name SRNet --dataset ./datasets/UAV-SC/test/shaded
```
The test results will be saved at the following path: `./result/SRNet/test_200/images`. This folder could be generated by our code autoAutomatically.

## Acknowledgments
Our code is inspired by [CycleGAN and pix2pix in PyTorch](https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix).
